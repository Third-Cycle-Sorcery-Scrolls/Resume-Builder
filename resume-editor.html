<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Resume Builder</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link id="template-style" rel="stylesheet"/>
    <style>
      input:valid{
        border: 1px solid green;
      }
      input:invalid {
        border: 1px solid red;
      }
    </style>
  </head>
  <body>
    <div class="editor-panel">
      <h2>Edit Resume</h2>

      <form id="resumeForm">
        <!--Personal Info Sec-->
        <div class="section-header">
          <span>Personal Info</span>
        </div>

        <div class="form-group">
          <label for="input_name">Full Name *</label>
          <input
            type="text"
            id="input_name"
            name="name"
            value="Amanuel Ayele"
            required
            minlength="3"
            maxlength="100"
            oninput="updateText('user_name', this.value)"
          />
        </div>

        <div class="form-group">
          <label for="input_title">Job Title *</label>
          <input
            type="text"
            id="input_title"
            name="title"
            required
            placeholder="Software Engineer"
            value="BACKEND DEVELOPER"
            minlength="2"
            maxlength="100"
            oninput="updateText('user_title', this.value)"
          />
        </div>

        <div class="form-group">
          <label for="input_photo">Profile Photo</label>
          <div class="file-upload">
            <input
              type="text"
              id="input_name"
              name="name"
              value="Amanuel Ayele"
              required
              minlength="3"
              maxlength="100"
              placeholder="Enter your name..."
              oninput="updateText('user_name', (this.value).trim())"
            />
            <div class="error-message" id="nameError"></div>
          </div>
          <div class="error-message" id="photoError"></div>
        </div>

          <div class="form-group">
            <label for="input_title">Job Title *</label>
            <input
              type="text"
              id="input_title"
              name="title"
              required
              placeholder = "Software Engineer"
              value="BACKEND DEVELOPER"
              minlength="2"
              maxlength="100"
              oninput="updateText('user_title', this.value)"
            />
          </div>

          <div class="form-group">
            <label for="input_photo">Profile Photo</label>
            <div class="file-upload">
              <input
                type="file"
                id="input_photo"
                name="photo"
                accept="image/*"
                onchange="updatePhoto(this)"
              />
              <div class="file-info" id="fileInfo">No file chosen</div>
              </div>
              <div class="error-message" id="photoError"></div>
          </div>

          <div class="form-group">
            <label for="input_summary">Professional Summary</label>
            <textarea
              id="input_summary"
              name="summary"
              required
              minlength="30"
              maxlength="300"
              rows="4"
              placeholder="Describe your professional background, skills, and carrer objectives..."
              oninput="updateText('user_summary', this.value)"
            >Experienced Backend Developer with 5+ years specializing in scalable web applications. Proficient in Node.js, Python, and cloud technologies. Passionate about clean architecture and system optimization.</textarea>
            <div class="char-count">
            </div>
            <div class="error-message" id="summaryError"></div>
          </div>

          <div class="section-header">
            <span>Contact Information</span>
          </div>

          <div class="form-group">
            <label>Phone *</label>
            <input
              type="tel"
              id="contact_phone_input"
              name="phone"
              value="+251911223344"
              placeholder="+25191234567"
              pattern="^\+?[\d\s]{10,}$"
              required
              oninput="updateText('contact_phone', this.value)"
            />
            <div class="error-message" id="phoneError"></div>
          </div>

          <div class="form-group">
            <label>Email *</label>
            <input
              type="email"
              id="contact_email_input"
              name="email"
              value="amanuel@example.com"
              required
              oninput="updateText('contact_email', this.value)"
            />
          </div>

          <div class="form-group">
            <label>Address</label>
            <input
              type="text"
              id="contact_address_input"
              name="address"
              value="Addis Ababa, Ethiopia"
              oninput="updateText('contact_address', this.value)"
            />
          </div>

          <div class="form-group">
            <label>Website/Portfolio</label>
            <input
              type="url"
              id="contact_website_input"
              name="website"
              value="https://www.amanuel.com"
              placeholder="https://yourportfolio.com"
              oninput="updateText('contact_website', this.value)"
            />
          </div>

          <div class="form-group">
            <label>LinkedIn Profile</label>
            <input
              type="url"
              id="contact_linkedin_input"
              name="linkedin"
              value="https://linkedin.com/in/amanuel_li"
              placeholder="https://(www\.)?lindedin\.com/.*"
              oninput="updateText('contact_linkedin', this.value)"
            />
          </div>

          <div class="section-header">
            <span>Experience</span>
          </div>
          <div id="experience_inputs">
            <!--Experience entries will be added here -->
          </div>
          <button type="button" class="btn" onclick="addExperience()">
            <span class="icon">+</span> Add Job
          </button>

          <div class="section-header">
            <span>Education</span>
          </div>
          <div id="education_inputs">
            <!--Education entries-->
          </div>
          <button type="button" class="btn" onclick="addEducation()">
            <span class="icon">+</span> Add Education</button>

          <div class="section-header">
            <span>Skills</span>
          </div>
          <div id="skills_inputs">
            <!--Skills-->
          </div>
          <button type="button" class="btn" onclick="addSkill()">
            <span class="icon">+</span> Add Skill</button>

          <br /><br />
          <button type="submit" id="submitBtn">Submit</button>
          <button
            disabled
            type="button"
            class="btn"
            id="printBtn"
            style="width:100%; background-color:#333;"
            onclick="window.print()"
          >
Experienced Backend Developer with 5+ years specializing in scalable web applications. Proficient in Node.js, Python, and cloud technologies. Passionate about clean architecture and system optimization.</textarea
          >
          <div class="char-count"></div>
          <div class="error-message" id="summaryError"></div>
        </div>

        <div class="section-header">
          <sapn>Contact Information</sapn>
        </div>

        <div class="form-group">
          <label>Phone *</label>
          <input
            type="tel"
            id="contact_phone_input"
            name="phone"
            value="+251 911 22 33 44"
            placeholder="+251 91 23 45 67"
            pattern="^\+?[\d\s]{10,}$"
            required
            oninput="updateText('contact_phone', this.value)"
          />
          <div class="error-message" id="phoneError"></div>
        </div>

        <div class="form-group">
          <label>Email *</label>
          <input
            type="email"
            id="contact_email_input"
            name="email"
            required
            value="amanuel@example.com"
            required
            oninput="updateText('contact_email', this.value)"
          />
        </div>

        <div class="form-group">
          <label>Address</label>
          <input
            type="text"
            id="contact_address_input"
            name="address"
            value="Addis Ababa, Ethiopia"
            oninput="updateText('contact_address', this.value)"
          />
        </div>

        <div class="form-group">
          <label>Website/Portfolio</label>
          <input
            type="url"
            id="contact_website_input"
            name="website"
            value="https://www.amanuel.com"
            placeholder="https://yourportfolio.com"
            oninput="updateText('contact_website', this.value)"
          />
        </div>

        <div class="form-group">
          <label>LinkedIn Profile</label>
          <input
            type="url"
            id="contact_linkedin_input"
            name="linkedin"
            value="https://linkedin.com/in/amanuel_li"
            placeholder="https://(www\.)?lindedin\.com/.*"
            oninput="updateText('contact_linkedin', this.value)"
          />
        </div>

        <div class="section-header">
          <span>Experience</span>
        </div>
        <div id="experience_inputs">
          <!--Experience entries will be added here -->
        </div>
        <button type="button" class="btn" onclick="addExperience()">
          <span class="icon">+</span> Add Job
        </button>

        <div class="section-header">
          <span>Education</span>
        </div>
        <div id="education_inputs">
          <!--Education entries-->
        </div>
        <button type="button" class="btn" onclick="addEducation()">
          <span class="icon">+</span> Add Education
        </button>

        <div class="section-header">
          <span>Skills</span>
        </div>
        <div id="skills_inputs">
          <!--Skills-->
        </div>
        <button type="button" class="btn" onclick="addSkill()">
          <span class="icon">+</span> Add Skill
        </button>

        <br /><br />
        <button type="submit">Submit</button>
        <button
          type="button"
          class="btn"
          id="printBtn"
          style="width:100%; background-color:#333;"
          onclick="window.print()"
        >
          <span class="icon">ðŸ“„</span> Download / Print PDF
        </button>
      </form>
    </div>

    <div class="preview-panel">
      <div class="resume-container">
        <div class="header">
          <h1 id="user_name">Amanuel Ayele</h1>
          <p id="user_title">BACKEND DEVELOPER</p>
        </div>

        <div class="left">
          <div class="avatar">
            <img
              id="user_photo"
              src="https://via.placeholder.com/150"
              alt="User Photo"
            />
          </div>

          <div>
            <div class="section-title">Contact</div>
            <div class="contact">
              <div><span id="contact_phone">+251 911 22 33 44</span></div>
              <div><span id="contact_email">amanuel@example.com</span></div>
              <div><span id="contact_address">Addis Ababa, Ethiopia</span></div>
              <div><span id="contact_website">www.amanuel.com</span></div>
              <div><span id="contact_linkedin">@amanuel_li</span></div>
            </div>
          </div>

          <div>
            <div class="section-title">Summary</div>
            <div class="summary" id="user_summary">
              Short professional summary goes here.
            </div>
          </div>

          <div>
            <div class="section-title">
              <span id="education_header">Education</span>
            </div>
            <div class="education" id="education_section">
              <!--Education -->
            </div>
          </div>

          <div>
            <div class="section-title">
              <span id="skills_header">Skills</span>
            </div>
            <div id="skills_section">

            </div>
          </div>
        </div>

        <div class="right">
          <div class="section-title">
            <span id="experience_header">Professional Experience</span>
          </div>

          <div id="experience_section"></div>
        </div>
      </div>
    </div>

    <script>
      const params = new URLSearchParams(window.location.search);
      const template = params.get("template") || "editor1";

      const link = document.getElementById("template-style");
      link.href = `css/${template}.css`;

      document.addEventListener('DOMContentLoaded', function() {
        const name = document.getElementById('input_name');
        const phone = document.getElementById('contact_phone_input');

        if(!name || !phone){
          return;
        }

        name.addEventListener('input', validateForm);
        phone.addEventListener('input', validateForm);

        name.addEventListener('blur', () => validateField("name"));
        phone.addEventListener('blur', function(){
          validateField("phone");
        });

        validateForm();
      });

      function validateField(field) {
        const name = document.getElementById('input_name');
        const phone = document.getElementById('contact_phone_input');

        const nameError = document.getElementById('nameError');
        const phoneError = document.getElementById('phoneError');

        if(field === 'name') {
          if(name.value.trim().length < 3) {
            nameError.textContent = "Name must be at least 3 characters.";
            nameError.style.color = "red";
            nameError.style.fontSize = "small";
          } else {
            nameError.textContent = "";
          }
        }

        if(field === 'phone') {
          const phonePattern = /^(\+\d{11,}|\d{10})$/;
          if(!phonePattern.test(phone.value.trim())) {
            phoneError.textContent = "Enter a valid phone number (min 10 digits, may include + or spaces).";
            phoneError.style.color = "red";
            phoneError.style.fontSize = "small";
          } else {
            phoneError.textContent = "";
          }
        }
      }


      function validateForm(){
        const name = document.getElementById('input_name');
        const phone = document.getElementById('contact_phone_input');
        const submitBtn = document.getElementById('submitBtn');
        const printBtn = document.getElementById('printBtn');

        let isValid = true;

        if(name.value.trim().length < 3){
          isValid = false;
        }

        const phonePattern = /^(\+\d{10,}|\d{10})$/;
        if(!phonePattern.test(phone.value.trim())){
          isValid = false;
        }

        //submitBtn.disabled = !isValid;
        printBtn.disabled = !isValid;
        
        return isValid;
      }

    </script>
    <script src="/js/livePreview.js"></script>
  </body>
</html>
